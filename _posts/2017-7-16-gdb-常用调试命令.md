---
layout:     post                    # 使用的布局（不需要改）
title:      常用调试命令              # 标题 
subtitle:     #副标题
date:       2017-7-16              # 时间
author:     co                      # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - gdb
---

最开始我们在window上都是使用visual studio调试的。在window上我们一般常用的是
- 启动 
- 添加删除断点 展示所有断点 
- 查看局部变量
- 单步执行
- 继续执行
- 查看堆栈
- 查看变量类型
- 查看代码中断位置附近的代码 
- 给调试的程序传入命令行参数
- 监视
- 退出调试


这些跟gdb是一一对应的。每个命令都可以简写，比如run ，输入 r 就可以了。

#### 启动
run命令。这个只要run一下，就会重新启动。简写 r
#### 添加删除断点 展示所有断点
- 添加断点 break  b 
- 删除 delete d
- 查看所有断点 info break

```
b 7 		第七行加一个断点
b 3 5		第三行和第五行分别加一个断点
d 7 		删除第七行的断点
d 3 5		删除断点3 和 断点5
info b 		显示所有断点
d 			删除所有断点
```
如果在其他文件里面打印断点则用 `b filename:line`

> 添加临时断点 tbreak 7 .因为有时候我只是想在某个地方停一下，之后这个断点就消失了。可以认为就是一次性断点。


#### 条件断点 
这样使用
```
b 13 if i==100  //当i为100的时候，停在13行
```

例子
```
0 
1 void fun()
2 {
3 	int i = 1;
4	while(true)
5	{
6		i++;
7		do_somethin();
8	}
9 }
10 void do_somethin()
11 {
12 		int a;
13		int b;
14 }

```
我想在i为100的时候，查看13行代码的情况。当然我可以直接修改代码，然后编译，调试。但是如果使用条件断点的话，就不用这么麻烦了。

```
b server.c:77  
```

> info thread 可以打印当前进程的所有线程 ，切换线程使用 thread number


#### 查看局部变量
print var表示查看变量 var。
```
print var	查看var变量的值
```

> print 还可以设置局部变量。比如循环开始是10，你想设置成1000看看是否有什么不同。

#### 单步执行
next
```
n 
```
实际上单步执行有两种
- step over 也就是我们的next。这种不会进入函数体
- step into 会进入遇见的函数体内部。


#### 继续执行
continue
```
c
```
#### 查看堆栈
backtrace
```
bt  打印堆栈

```
我们在vs中经常可以点击某一帧查看，gdb使用 frame 3 
```
f 3 //查看第三帧
```
#### 查看变量类型
ptype 这个对于查看结构体的成员很有用
```
ptype var
```
不过成员很多的话，要按回车键才能看完。
#### 查看代码中断位置附近的代码
list 
```
l
```
list+ list- 是对查看代码范围的移动

#### 给调试的程序传入命令行参数
在执行run命令前，是传入命令行参数的时机。
像这样
```
set arg  参数1 参数2 
```
执行后显示参数命令
```
show arg
```
#### 监视
watch express 例子
```
watch (i>50 && i<100 ) 	当这个表达式发生改变的时候 调试就会停止。当然本质还是i发生改变了
watch var 				当var发生改变的时候 调试就会停止。
```
但是需要注意如果是栈中的变量，那么生命周期结束后，这个监视也就是无效了
#### 退出调试
quit
```
q
```

#### 总结
基本上gdb只是调试代码用，阅读代码还是要用其他编辑器。比如ptype vare 查看变量成员，如果成员多了就需要按回车键看其他的。所以本地还是要打开一个代码编辑器查看代码。

> ctrl + c 可以让调试中断 ，当 输入 c 命令的时候，又会继续执行


#### 结束


