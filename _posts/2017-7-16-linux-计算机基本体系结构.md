---
layout:     post                    # 使用的布局（不需要改）
title:      计算机基本体系结构               # 标题 
subtitle:     #副标题
date:       2017-7-16              # 时间
author:     co                      # 作者
header-img: img/post-bg-2015.jpg    #这篇文章标题背景图片
catalog: true                       # 是否归档
tags:                               #标签
    - 操作系统
---

## 内存
- 在超市购物前，我们一般会先寄存手上有的东西。有个很多寄存柜，上面都有标号。通过标号我们就可以存我们的物品和取出来我们的物品。这个标号就类似内存的地址，物品就是内存里面存放的内容。
- 32位的系统架构有4G的内存单元。因为是2的32次方，而每个内存单元是一个字节。

## cpu
cpu的作用就是不断从内存取指令，解释，最后执行。指令做两件事情，读写内存，或者做运算。cpu核心部件有程序计数器单元，运算寄存器，存储寄存器，指令解释器，总线。
- 举个例子。cpu从内存读数据。cpu通过控制总线发送读信息给内存，内存收到信息后，通过数据总线把数据传送到cpu寄存器。本质上寄存器也是一个存储单元，容量小，但是速度快。如果是x86体系的话，地址线和数据线都是32位，也就是每一次传递的数据最多是4个字节。
- 举个取指令执行的例子。比如执行c语言 `b=a+1` 当然这里转化成汇编后，不是一条指令，而是三条。cpu通过程序计数器指定的位置开始取指令
  - 把内存a里面的内容放到寄存器
  - 通过运算单元把寄存器的数字增加 1
  - 把寄存器的数据写入到内存b里面

- 程序计数器不断的读取下一条指令，并不是简单的把上一条指令的起始地址加1。因为每条指令的长度占用的字节是不同的，所以下一条指令是要加1是指以指令为单位跳转。
- 每次取出指令后，通过指令解释器来说明这条指令想做什么。比如这条指令是想做运算，那么里面会指定是使用哪个寄存器，哪个运算单元等，然后安排其他部件去执行。


## 设备
设备分为跟cpu直连还是通过控制器连接。我们访问设备，最终是指访问设备内部的寄存器。类似与访问内存，所以每个设备都有地址范围。

## mmu
mmu即内存管理单元。
- 在cpu中，我们访问内存并不是直接访问内存的物理地址，而是发送的虚拟地址VA给mmu，mmu再发送PA给内存。具体是这样。物理内存中有一张表保存了虚拟地址和物理地址的映射。在系统启动或者有内存分配变化的时候，会在物理内存里面更新映射。映射是以页为单位。页（page）是虚拟内存的叫法，物理内存叫做page frame。32位体系的页的大小是4kb。
- mmu设置了对va设置了不同的访问权限。比如特定模式下才能访问哪些内存，这样VA才会被转换成PA，进行真正的内存访问。

## over